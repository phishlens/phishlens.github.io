<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>PhishLens â€“ Email Header Analysis & Phishing Detection Tool</title>

<!-- SEO -->
<meta name="description" content="PhishLens is a browser-based email header analysis tool for phishing detection, threat intelligence lookups, and security investigations.">

<meta name="keywords" content="
phishing analysis,
email header analysis,
phishing detection,
email forensics,
threat intelligence,
AbuseIPDB,
VirusTotal,
email security,
phishing investigation,
SOC tools,
incident response,
blue team,
cybersecurity tools
">

<meta property="og:title" content="PhishLens â€“ Email Header Analysis Tool">
<meta property="og:description" content="Analyze email headers for phishing indicators, brand impersonation, and sender IP reputation using client-side threat intelligence links.">
<meta property="og:type" content="website">
<meta property="og:url" content="https://phishlens.github.io/">
<meta property="og:image" content="https://phishlens.github.io/social-preview.png">
<meta name="twitter:card" content="summary_large_image">



<link rel="icon" href="favicon.ico">
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root {
  --bg:#ffffff;
  --fg:#111;
  --card:#f3f3f3;
  --border:#ccc;
  --link:#0969da;
  --warn:#b45309;
}

.dark {
  --bg:#0d1117;
  --fg:#e6edf3;
  --card:#161b22;
  --border:#30363d;
  --link:#58a6ff;
  --warn:#f59e0b;
}

body {
  background:var(--bg);
  color:var(--fg);
  font-family:system-ui,-apple-system,BlinkMacSystemFont;
  max-width:1100px;
  margin:30px auto;
  padding:0 15px;
}

body, .card, textarea, input, button, table {
  transition: background-color 0.25s ease, color 0.25s ease, border-color 0.25s ease;
}

textarea,input {
  width:100%;
  background:var(--card);
  color:var(--fg);
  border:1px solid var(--border);
  border-radius:6px;
  padding:10px;
  font-family:monospace;
}

button {
  background:#238636;
  color:#fff;
  border:none;
  padding:8px 14px;
  border-radius:6px;
  margin-top:10px;
  cursor:pointer;
}

button:disabled {
  opacity:0.7;
  cursor:not-allowed;
}

.card {
  background:var(--card);
  border:1px solid var(--border);
  border-radius:10px;
  padding:15px;
  margin-top:20px;
}

.HIGH { color:#ff7b72; font-weight:bold; }
.MEDIUM { color:#f2cc60; font-weight:bold; }
.LOW { color:#3fb950; font-weight:bold; }

a { color:var(--link); text-decoration:none; }

.grid {
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:8px;
}

pre {
  background:#00000022;
  padding:10px;
  border-radius:6px;
  overflow-x:auto;
}

#darkToggle {
  position:fixed;
  top:16px;
  right:16px;
  background:#444;
  color:#fff;
  border-radius:6px;
  padding:6px 10px;
  cursor:pointer;
  z-index:1000;
}

.dark #darkToggle { background:#222; }

table {
  width:100%;
  border-collapse:collapse;
  font-size:0.9em;
}
th, td {
  border:1px solid var(--border);
  padding:6px 8px;
  vertical-align:top;
}
th {
  background:#00000022;
  text-align:left;
}
td code { word-break:break-all; }

.suspicious {
  background:rgba(245,158,11,0.15);
  color:var(--warn);
  font-weight:bold;
}

details summary {
  cursor:pointer;
  font-weight:bold;
  margin-bottom:8px;
}
</style>
</head>

<body>

<button id="darkToggle" onclick="toggleDark()">ðŸŒ™</button>

<div style="display:flex;align-items:center;gap:15px;margin-bottom:10px;">
  <img src="Phishlens.png" alt="PhishLens logo" style="height:64px;">
  <div>
    <h1 style="margin:0;">PhishLens</h1>
    <p style="margin:0;"><i>See through phishing emails.</i></p>
  </div>
</div>

<div class="card">
<h3>Paste Email Headers</h3>
<textarea id="headers" rows="8" placeholder="Paste raw email headers here..."></textarea>
<button onclick="analyze(this)">Analyze</button>
</div>

<div class="card">
<h3>Upload .eml File</h3>
<input type="file" id="eml" accept=".eml">
</div>

<div id="result"></div>

<p style="margin-top:40px;font-size:0.9em;color:gray;">
All analysis is performed locally in your browser. No data is transmitted.
</p>

<script>
const BRANDS = {
  microsoft:["microsoft","outlook","office","office365","teams"],
  google:["google","gmail"],
  apple:["apple","icloud","appleid"],
  paypal:["paypal"],
  amazon:["amazon","prime"],
  meta:["facebook","instagram"],
  dhl:["dhl"],
  fedex:["fedex"],
  ups:["ups"],
  binance:["binance"],
  coinbase:["coinbase"]
};

const SUSPICIOUS_HEADERS = [
  "x-spam",
  "received-spf",
  "authentication-results",
  "x-authentication-warning"
];

function applyTheme(d){
  document.body.classList.toggle("dark",d);
  localStorage.setItem("dark",d);
}
function toggleDark(){ applyTheme(!document.body.classList.contains("dark")); }
(function(){
  const s=localStorage.getItem("dark");
  applyTheme(s!==null?s==="true":matchMedia("(prefers-color-scheme: dark)").matches);
})();

document.getElementById("eml").addEventListener("change",e=>{
  const r=new FileReader();
  r.onload=()=>{ headers.value=r.result.split(/\r?\n\r?\n/)[0]; analyze(); };
  r.readAsText(e.target.files[0]);
});

function parseHeaders(raw){
  const o={},l=[];
  raw.split(/\r?\n/).forEach(x=>{
    if(x.startsWith(" ")&&l.length) o[l[l.length-1]]+=" "+x.trim();
    else {
      const i=x.indexOf(":");
      if(i>0){
        const k=x.slice(0,i).toLowerCase();
        o[k]=x.slice(i+1).trim();
        l.push(k);
      }
    }
  });
  return o;
}

function renderOtherHeaders(h){
  const skip=["received","from","reply-to","return-path","subject"];
  let i=1;
  const rows=Object.entries(h).filter(([k])=>!skip.includes(k)).map(([k,v])=>{
    const suspicious=SUSPICIOUS_HEADERS.some(s=>k.includes(s));
    return `<tr class="${suspicious?"suspicious":""}">
      <td>${i++}</td><td>${k}</td><td><code>${v}</code></td>
    </tr>`;
  }).join("");

  return rows?`
  <div class="card">
    <details>
      <summary>Other Headers (click to expand)</summary>
      <table>
        <thead><tr><th>#</th><th>Header</th><th>Value</th></tr></thead>
        <tbody>${rows}</tbody>
      </table>
    </details>
  </div>`:"";
}

function analyze(btn){
  if(btn){btn.disabled=true;btn.textContent="Analyzingâ€¦";}
  const raw=headers.value.trim();
  if(!raw){btn.textContent="Analyze";btn.disabled=false;return;}

  const h=parseHeaders(raw);
  const rec=h["received"]||"";
  const ip=(rec.match(/\b\d{1,3}(?:\.\d{1,3}){3}\b/g)||[]).pop();

  const identity=[h.from,h["reply-to"],h["return-path"],h.subject].join(" ").toLowerCase();
  const brands=Object.keys(BRANDS).filter(b=>BRANDS[b].some(k=>identity.includes(k)));

  let score=0,reasons=[];
  if(brands.length){score+=25;reasons.push("Brand impersonation indicators detected");}
  if(/urgent|verify|password|login|account|suspend/i.test(h.subject||"")){
    score+=15;reasons.push("Urgent or security-related language detected");
  }

  const level=score>=75?"HIGH":score>=45?"MEDIUM":"LOW";

  const ti = ip ? `
  <div class="card">
    <h2>Threat Intelligence (Sender IP)</h2>
    <div class="grid">
      <a href="https://www.abuseipdb.com/check/${ip}" target="_blank">AbuseIPDB</a>
      <a href="https://www.virustotal.com/gui/ip-address/${ip}" target="_blank">VirusTotal</a>
      <a href="https://viz.greynoise.io/ip/${ip}" target="_blank">GreyNoise</a>
      <a href="https://www.shodan.io/host/${ip}" target="_blank">Shodan</a>
      <a href="https://search.censys.io/hosts/${ip}" target="_blank">Censys</a>
      <a href="https://otx.alienvault.com/indicator/ip/${ip}" target="_blank">AlienVault OTX</a>
      <a href="https://ipinfo.io/${ip}" target="_blank">IPinfo</a>
      <a href="https://talosintelligence.com/reputation_center/lookup?search=${ip}" target="_blank">Cisco Talos</a>
    </div>
  </div>` : "";

  result.innerHTML=`
  <div class="card">
    <h2>Verdict</h2>
    Score: <b>${score}/100</b><br>
    Risk:
    <span class="${level}" style="border:1px solid currentColor;padding:2px 8px;border-radius:4px;">
      ${level}
    </span>
    <ul>${reasons.map(r=>`<li>${r}</li>`).join("")}</ul>
  </div>

  <div class="card">
    <h2>Brand Detection</h2>
    ${brands.length?`Detected: <b>${brands.join(", ")}</b>`:"No brand indicators detected"}
    <p style="font-size:0.9em;color:gray;">
      Brand detection is based on identity fields and does not guarantee affiliation.
    </p>
  </div>

  ${ti}
  ${renderOtherHeaders(h)}
  `;

  result.scrollIntoView({behavior:"smooth"});
  btn.textContent="Analyze";
  btn.disabled=false;
}
</script>

</body>
</html>
